function I(e){return e*164579e-9}function R(e){return e*.514444}function u(e){return e*(Math.PI/180)}function Y(e){return e*(180/Math.PI)}function z(e){return 90-e}function E(e){return(e%360+360)%360}const O=32.2;function G(e,l,d,g,h,f,m){let a=.5,r=0,o=R(e),y=(f+180)%360,F=R(h),P=F*Math.cos(u(y)),B=F*Math.sin(u(y)),C=P*a,W=B*a,i=[],n={x:0,y:0,hdgDeg:g,ktas:o,angleOfBank:0};for(i.push({x:n.x,y:n.y});r<m;){let t;n.angleOfBank<l?t=n.angleOfBank+d*a:t=l;let M,x=u(t);M=Y(O*Math.tan(x)/o);let A=M*a,s;Math.abs(t)>0?s=o**2/(O*Math.tan(Math.abs(x))):s=1e6;let T=t>=0?-1:1,S=E(n.hdgDeg+T*A),k=o*a/s;T=t>=0?-1:1;let w=s*Math.sin(k),p=T*s*(1-Math.cos(k)),c=u(z(S)),b=w*Math.cos(c)-p*Math.sin(c),v=w*Math.sin(c)+p*Math.cos(c),H=n.x+b+C,N=n.y+v+W,D={x:H,y:N,hdgDeg:S,ktas:n.ktas,angleOfBank:t,turnRateDeg:M};i.push({x:D.x,y:D.y}),n=D,r+=a}return i=i.map(t=>({x:I(t.x),y:I(t.y)})),i}self.onmessage=function(e){const{ktas:l,maxAngleOfBankDeg:d,rollRateDeg:g,currentHeading:h,windSpeed:f,windDirection:m,timeAfterTurnStarted:a}=e.data;try{const r=G(l,d,g,h,f,m,a);self.postMessage({success:!0,points:r})}catch(r){self.postMessage({success:!1,error:r instanceof Error?r.message:"Unknown error occurred"})}};
